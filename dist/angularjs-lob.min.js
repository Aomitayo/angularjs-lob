!function(){"use strict";angular.module("angularjsLob.config",[]).value("angularjsLob.config",{debug:!0}),angular.module("angularjsLob.directives",[]),angular.module("angularjsLob.filters",[]),angular.module("angularjsLob.services",["restangular"]),angular.module("angularjsLob",["angularjsLob.config","angularjsLob.directives","angularjsLob.filters","angularjsLob.services"]),angular.module("angularjsLob.directives").directive("resourceView",["$compile","$controller","$parse","$q","resourceViews",function(e,n,t,r,o){return{template:'<div class="resourceView"><i class="icon-spin icon-spinner"></i></div>',replace:!1,restrict:"A",compile:function(){return function(t,r,i){function u(u){var a=i.view;o.controllerFor(a,u).then(function(e){e&&n(e,{$scope:t})}),o.templateFor(a,u).then(function(n){var o=e(n)(t);r.empty().append(o).removeClass("loading")})}r.addClass("is-loading"),t.$watch(i.resource,u)}}}}]),angular.module("angularjsLob.services").constant("resourceCollection",function(){var e=this,n=this;if(!angular.isArray(n))throw new Array("Resource collection should be mixed unto an array");e._revision=0,e.revision=function(){return e._revision},e._updateRevision=function(){this._revision=Math.abs(9e3*Math.random())+1e3},e.append=function(e,t){n.push(e),t||this._updateRevision()},e.appendItems=function(e,t){angular.forEach(e,function(e){n.push(e)}),t||this._updateRevision()},e.prepend=function(e){n.unshift(e),this._updateRevision()},e.prependItems=function(e){angular.forEach(e,function(e){n.unshift(e)}),this._updateRevision()},e.insert=function(e,t){n.splice(e,0,t),this._updateRevision()},e.insertItems=function(e,n){var t=this;angular.forEach(n.reverse(),function(n){t.insert(e,n)}),this._updateRevision()},e.removeItem=function(e,t){var r=this.itemIndex(e,t);-1!==r&&(n.splice(r,1),this._updateRevision())},e.removeAll=function(){n.splice(0,n.length),this._updateRevision()},e.replaceItem=function(e,t){var r=this.itemIndex(e);-1!==r&&(n.splice(r,1,t),this._updateRevision())},e.itemIndex=function(e,t){var r=this.compareItems;r="function"==typeof t?t:"boolean"==typeof t&&t?this.compareItems:void 0;var o=n.indexOf(e);if(-1===o&&r){for(var i=0;n>i;i++)if(r(e,n[i]))return i;return-1}return o},e.compareItems=function(e,n,t){return t=t||"id",e[t]&&n[t]?e[t]===n[t]:!1}}),angular.module("angularjsLob.services").provider("resourceContext",function(){var e={};this.resourceModel=function(n,t,r){e[n]={config:angular.extend({name:n,route:t},r||{})}},this.$get=["resourceModelFactory","ResourceQuery",function(n,t){return{resourceModel:function(t){if(!e[t])throw new Error(t+" is not a known model. Ensure you have defined it");return e[t].model=e[t].model||n(e[t].config),e[t].model},query:function(e,n){return new t(this.resourceModel(e),n)},find:function(e,n){return this.query(e,n).execute()}}}]}),angular.module("angularjsLob.services").factory("ResourceCursor",["$q","resourceCollection",function(e,n){function t(e,t,r){var o=this;n(this),o.isLoading=!1,o.isEof=!1,o.model=e,o.params=t,r&&this.appendItems(r),this.more=function(){o.isLoading=!0;var n=angular.extend({},o.params,{skip:o.length,limit:10});e.getList(n).then(function(e){return e=e||[],o.appendItems(e,!0),o.params=n,o.isLoading=!1,o.isEof=0===e.length,e.pagination?o.count=e.pagination.count:0===e.length&&(o.count=o.length),e})}}return t.prototype=[],t}]),angular.module("angularjsLob.services").factory("resourceModelFactory",["Restangular",function(e){return function(n){if(!n.route||!n.typeName)throw new Error("ResourceModel must have route and typename");var t=e.allUrl(n.route);return t.create=function(r){return r=r||{},r=e.restangularizeElement(t,r,n.route),r.typeName=function(){return n.typeName},r},e.extendModel(t.route,function(t){return t.copy=function(){return e.copy(t)},t.typeName=function(){return n.typeName},t}),t}}]),angular.module("angularjsLob.services").factory("ResourceQuery",["$q","ResourceCursor",function(e,n){function t(e,n){this.model=e,this.params=n}return t.prototype.offset=function(e){this.params.offset=e},t.prototype.limit=function(e){this.params.limit=e},t.prototype.execute=function(){var e=this;return e.model.getList(e.params).then(function(t){return t=t||[],new n(e.model,e.params,t)})},t}]),angular.module("angularjsLob.services").provider("resourceViewTemplates",function(){var e={},n=function(e){return e=e||{},"string"==typeof e?e:e.typeName&&e.typeName()};this.resourceTypeIdentifier=function(e){n=e},this.urlFor=function(n,t,r){e[n]=e[n]||{},e[n][t]=e[n][t]||{},e[n][t].url=r},this.contentFor=function(n,t,r){e[n]=e[n]||{},e[n][t]=e[n][t]||{},e[n][t].content=r},this.$get=["$q","$injector","$http","$templateCache",function(t,r,o,i){return{get:function(u,a){var s=n(a),c=t.defer(),l=e[s];if(l){var f=l[u];f&&f.url?t.when(f.url).then(function(e){return angular.isFunction(f.url)||angular.isArray(f.url)?r.invoke(f.url,{},{resource:a}):e}).then(function(e){var n=i.get(e);return n?n:(i.put(e,o.get(e).then(function(n){return i.put(e,n.data),n.data})),i.get(e))}).then(function(e){c.resolve(e)},function(e){c.reject(e)}):f&&f.content?t.when(f.content).then(function(e){return angular.isFunction(f.content)||angular.isArray(f.content)?r.invoke(f.content,{},{resource:a}):e}).then(function(e){c.resolve(e)},function(e){c.reject(e)}):c.reject("No Template Configuration was found for "+u+" view of the "+s+" resource")}else c.reject("No Template Configuration was found for "+s);return c.promise}}}]}),angular.module("angularjsLob.services").provider("resourceViews",function(){var e={},n=function(e){return e=e||{},"string"==typeof e?e:e.typeName&&e.typeName()};this.resourceTypeIdentifier=function(e){n=e},this.templateUrlFor=function(n,t,r){e[n]=e[n]||{},e[n][t]=e[n][t]||{},e[n][t].url=r},this.templateFor=function(n,t,r){e[n]=e[n]||{},e[n][t]=e[n][t]||{},e[n][t].content=r},this.uiStateFor=function(n,t,r){e[n]=e[n]||{},e[n][t]=e[n][t]||{},e[n][t].uiState=r},this.controllerFor=function(n,t,r){e[n]=e[n]||{},e[n][t]=e[n][t]||{},e[n][t].controller=r},this.$get=["$q","$injector","$http","$templateCache",function(t,r,o,i){function u(o,i){return function(u,a){var s=n(a),c=t.defer(),l=e[s];if(l){var f=(l[u]||{})[o]||(l.all||{})[o];f?t.when(f).then(function(e){return angular.isFunction(e)||angular.isArray(e)?r.invoke(e,{},{resource:a}):e}).then(function(e){return i?i(e):e}).then(function(e){c.resolve(e)},function(e){c.reject(e)}):c.resolve(null)}else c.resolve(null);return c.promise}}return{templateFor:function(u,a){var s=n(a),c=t.defer(),l=e[s];if(l){var f=l[u];f&&f.url?t.when(f.url).then(function(e){return angular.isFunction(f.url)||angular.isArray(f.url)?r.invoke(f.url,{},{resource:a}):e}).then(function(e){var n=i.get(e);return n?n:(i.put(e,o.get(e).then(function(n){return i.put(e,n.data),n.data})),i.get(e))}).then(function(e){c.resolve(e)},function(e){c.reject(e)}):f&&f.content?t.when(f.content).then(function(e){return angular.isFunction(f.content)||angular.isArray(f.content)?r.invoke(f.content,{},{resource:a}):e}).then(function(e){c.resolve(e)},function(e){c.reject(e)}):c.reject("No Template Configuration was found for "+u+" view of the "+s+" resource")}else c.reject("No Template Configuration was found for "+s);return c.promise},uiStateFor:u("uiState",function(e){return"string"==typeof e?{name:e}:e}),controllerFor:u("controller")}}]})}();